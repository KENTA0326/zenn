---
title: "アソシエーション"
emoji: "🙆"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [rails]
published: true
---

# はじめに
　学び始めて何度苦しめられたかわからないアソシエーションについてまとめていきます。

## 1:Nの関係
　1:Nの関係は１:多という時もあります。
　
```rb.user
has_many :posts, dependent: :destroy
```
　userとpostはユーザーが何個も投稿できるという点でuserが１、postが多になります。
`dependent: :destroy`は投稿したユーザーが退会したらその投稿も全部なくなるよという意味になります。

postの方は以下の記述になります。
```rb.post
belongs_to :user
```

## 使用する時
 post.user.nameを例に説明していきます。
これを記述すると投稿したユーザーの名前がわかります。

これはpostがユーザーの`user_id`という外部キーを所持しているため可能になります。
外部キーを所持していると関連するuserの情報を参照できるようになります。

:::details 外部キーがないと、、、
投稿した人が誰なのか参照することが不可能になります。
必ず存在しなければならないという系統のエラー(〜must exist)が発生する可能性があり、実際以下のエラーが発生しました.
```
Book must exist
```
これは以前作成したbookers2というアプリを参考にした際、アソシエーションの名前もそのままにしていたのが原因でした。
:::

## まとめ
　railsのアソシエーションは作成するアプリが複雑になればなるほど重要になってきます。
今後さらに難易度の高い技術も存在するため、ここで立ち返ってみるのもありかなと。
参考になれば幸いです。


