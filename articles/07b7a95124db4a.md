---
title: "helperã‚’ä½¿ç”¨ã—ãŸã‚¢ã‚¯ã‚»ã‚¹æ¨©é™"
emoji: "ğŸ¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [rails]
published: true
---

## helperã¨ã¯
ã€€helperã¨ã¯viewã‚„controllerã§ã¡ã‚‡ã£ã¨ã—ãŸå‡¦ç†ã‚’ã‚„ã‚ŠãŸã„æ™‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
viewã¨åˆ¥ã®å ´æ‰€(helper)ã§å®šç¾©ã—ã¦ãŠã„ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’viewã‹ã‚‰å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã‚‹ã‚‚ã®ã§ã™ã€‚

## ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®æ–¹æ³•

ã¾ãš`application_helper.rb`ã«admin_urlã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
```
module ApplicationHelper

  def admin_url?
    request.fullpath.include?("/admin")
  end

end
```
ã“ã® admin_url? ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ç®¡ç†è€…ç”¨ã®URLã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚
å…·ä½“çš„ã«ã¯ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ•ãƒ«ãƒ‘ã‚¹ã« "/admin" ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã« true ã‚’è¿”ã—ã€ãã‚Œä»¥å¤–ã®å ´åˆã« false ã‚’è¿”ã—ã¾ã™ã€‚

ä»¥ä¸‹ãŒã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®èª¬æ˜ã§ã™

`request.fullpath`: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚ã“ã‚Œã«ã¯ãƒ›ã‚¹ãƒˆåã‚„ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚
`include?("/admin")`: ãƒ•ãƒ«ãƒ‘ã‚¹ã« "/admin" ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™ã€‚å«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ true ã‚’è¿”ã—ã€å«ã¾ã‚Œã¦ã„ãªã„å ´åˆã¯ false ã‚’è¿”ã—ã¾ã™ã€‚

## ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®è¨˜è¿°

`application_controller.rb`ã«ä»¥ä¸‹ã®è¨˜è¿°ã‚’è¡Œã„ã¾ã™ã€‚
```
include ApplicationHelper

before_action :authenticate_admin!, if: :admin_url?
```

å…ˆã»ã©ã®helperãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã€urlã«adminãŒå«ã¾ã‚Œã¦ã„ã‚Œã°ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ
ç®¡ç†è€…å´ã®ãƒšãƒ¼ã‚¸ã«é·ç§»å‡ºæ¥ãªã„ã‚ˆã†ã«è¨­å®šã§ãã¾ã™ã€‚

## æœ€å¾Œã«
ã€€helperã§ã¯ãªãcontrollerã«è¨˜è¿°ã—ã¦ã‚‚åŒã˜æŒ™å‹•ã‚’ã¨ã‚‹ãŸã‚ã€å€‹äººã®ãŠå¥½ã¿ã§ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

### ps
application_controllerå†…ã§ï¼‘è¡Œã«ã¾ã¨ã‚ãŸã„å ´åˆã«ã¯ä»¥ä¸‹ã®è¨˜è¿°ã‚’ã—ã¦ãã ã•ã„

```
before_action :authenticate_admin!, if: -> { request.path =~ /^\/admin/ }
```

